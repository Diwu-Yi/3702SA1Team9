color="blue",
fill="blue",
alpha=0.2,
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=3
)
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
BrandPreference
unique(df$rating[df$vehicle.make=="Acura"])
df[df$vehicle.make=="Acura"]
df[df$vehicle.make=="Acura",]
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))%>%ungroup()
BrandPreference
specie <- c(rep("sorgho" , 3) , rep("poacee" , 3) , rep("banana" , 3) , rep("triticum" , 3) )
condition <- rep(c("normal" , "stress" , "Nitrogen") , 4)
value <- abs(rnorm(12 , 0 , 15))
data <- data.frame(specie,condition,value)
data
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
ggplot(BrandPreference,aes(x=vehicle.make,y=weighted.mean(rating, renterTripsTaken)))+geom_bar()
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
ggplot(BrandPreference,aes(x=vehicle.make,y=weighted.mean(rating, renterTripsTaken)))+geom_bar()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
ggplot(BrandPreference,aes(x=vehicle.make,y="weighted.mean(rating, renterTripsTaken")))+geom_bar()
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
ggplot(BrandPreference,aes(x=vehicle.make,y="weighted.mean(rating, renterTripsTaken"))+geom_bar()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
ggplot(BrandPreference,aes(x=vehicle.make,y="weighted.mean(rating, renterTripsTaken"))+geom_bar(stat = "identity")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
BrandPreference
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, aes(x=Brand, y=WeightedAverageRating)) + geom_bar(stat = "identity")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, aes(x=Brand, y=WeightedAverageRating)) + geom_bar(stat = "identity")+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, aes(x=Brand, y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+ylim(4,5)
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+ylim(3,5)
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+xlim(3,5)
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+ylim(3,5)
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+scale_y_continuous(limits = c(3, 5))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top5 = rank(-WeightedAverageRating) %in% 1:5)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top5)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top5 = rank(-WeightedAverageRating) %in% 1:5)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()
BrandPreference
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
for (j in 1:nrow(df)){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
index <- which(df$vehicle.make==BrandPreference$Brand[i])
for (j in index){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
index <- which(df$vehicle.make==BrandPreference$Brand[i])
for (j in index){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
ggplot(df, aes(fill=vehicle.type, y=WeightedAverageRating, x=vehicle.make)) +
geom_bar(position="stack", stat="identity")
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
index <- which(df$vehicle.make==BrandPreference$Brand[i])
for (j in index){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
ggplot(df, aes(fill=vehicle.type, y=WeightedAverageRating, x=vehicle.make)) +
geom_bar(position="stack", stat="identity")+coord_flip()
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,formatC(WeightedAverageRating,digits = 2,format = "f")), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=formatC(WeightedAverageRating,digits=2),fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=formatC(WeightedAverageRating,digits=2),fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-formatC(BrandPreference$WeightedAverageRating, digits = 2, format = "f")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
View(BrandPreference)
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-formatC(BrandPreference$WeightedAverageRating, digits = 2, format = "f")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.5)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-formatC(BrandPreference$WeightedAverageRating, digits = 5, format = "f")
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
BrandPreference
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 5, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1,color="white"))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 2, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
BrandPreference <- mutate(BrandPreference, top8 = rank(-WeightedAverageRating) %in% 1:8)
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top8)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
ggplot(df)+geom_point(aes(x=vehicle.year,y=rating,size=renterTripsTaken))
ggplot(df)+geom_jitter(aes(x=vehicle.year,y=rating,size=renterTripsTaken))
ggplot(df)+geom_jitter(aes(x=vehicle.year,y=rating,size=renterTripsTaken),alpha=0.3)
ggplot(df)+geom_point(aes(x=vehicle.year,y=rating,size=renterTripsTaken),alpha=0.3)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))
str(df)
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))+geom_boxplot(width=0.1, color="grey", alpha=0.2) +
scale_fill_viridis(discrete = TRUE) +
theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
)
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))+geom_boxplot(width=0.1, color="grey", alpha=0.2)
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
index <- which(df$vehicle.make==BrandPreference$Brand[i])
for (j in index){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
ggplot(df, aes(fill=vehicle.type, y=WeightedAverageRating, x=vehicle.make)) +
geom_bar(position="stack", stat="identity")+coord_flip()
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_point(aes(x=vehicle.year,y=WeightedAverageRating))
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_point(aes(x=vehicle.year,y=rating))
PreferredYear <- df%>%group_by(vehicle.year)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(PreferredYear)<-c("Year","WeightedAverageRating")
PreferredYear$WeightedAverageRating<-as.numeric(formatC(PreferredYear$WeightedAverageRating, digits = 4, format = "f"))
PreferredYear <- mutate(PreferredYear, top5 = rank(-WeightedAverageRating) %in% 1:5)
ggplot(PreferredYear, mapping=aes(x=reorder(Year,WeightedAverageRating), y=WeightedAverageRating,fill=top5)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
PreferredYear <- df%>%group_by(vehicle.year)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(PreferredYear)<-c("Year","WeightedAverageRating")
PreferredYear$WeightedAverageRating<-as.numeric(formatC(PreferredYear$WeightedAverageRating, digits = 4, format = "f"))
PreferredYear <- mutate(PreferredYear, top5 = rank(-WeightedAverageRating) %in% 1:5)
ggplot(PreferredYear, mapping=aes(x=Year, y=WeightedAverageRating,fill=top5)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))
library(shiny); runApp('Lesson 10/app-V4.R')
runApp('Lesson 10/final-app.R')
runApp('Lesson 10/FirstAPP.R')
library(dplyr)
library(readr)
library(tidyr)
library(stringr)
library(ggplot2)
library(gganimate)
library(hrbrthemes)
library(viridis)
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
index <- which(df$vehicle.make==BrandPreference$Brand[i])
for (j in index){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
top <- function(index){
rank(-BrandPreference$WeightedAverageRating)%in%1:index
}
BrandPreference <- mutate(BrandPreference, top=top(8))
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
df$WeightedAverageRating <- NA
for (i in 1:nrow(BrandPreference)){
if (BrandPreference$Brand[i]%in%df$vehicle.make){
index <- which(df$vehicle.make==BrandPreference$Brand[i])
for (j in index){
df$WeightedAverageRating[j]<-BrandPreference$WeightedAverageRating[i]
}
}
}
ggplot(df, aes(fill=vehicle.type, y=WeightedAverageRating, x=vehicle.make)) +
geom_bar(position="stack", stat="identity")+coord_flip()
View(df)
df$vehicle.year<- as.character(df$vehicle.year)
ggplot(df)+geom_violin(aes(x=vehicle.year,y=rating))
PreferredYear <- df%>%group_by(vehicle.year)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(PreferredYear)<-c("Year","WeightedAverageRating")
PreferredYear$WeightedAverageRating<-as.numeric(formatC(PreferredYear$WeightedAverageRating, digits = 4, format = "f"))
PreferredYear <- mutate(PreferredYear, top5 = rank(-WeightedAverageRating) %in% 1:5)
ggplot(PreferredYear, mapping=aes(x=Year, y=WeightedAverageRating,fill=top5)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
library(shiny); runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Lesson 10/final-app.R')
runApp('Lesson 10/app-V2.2.R')
runApp('Lesson 10/app-V4.R')
runApp('Lesson 10/final-app.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
library(dplyr)
library(readr)
library(tidyr)
library(stringr)
library(ggplot2)
library(gganimate)
library(hrbrthemes)
library(viridis)
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
df <- read.csv("/Users/elianasong/Desktop/y3s1/DBA3702/Project/data cleaned/CleanedCarRentalData.csv")
df <- subset(df,vehicle.type!="truck")
BrandPreference <- df%>%group_by(vehicle.make)%>%summarise(weighted.mean(rating,renterTripsTaken))
colnames(BrandPreference)<-c("Brand","WeightedAverageRating")
BrandPreference$WeightedAverageRating<-as.numeric(formatC(BrandPreference$WeightedAverageRating, digits = 4, format = "f"))
top <- function(index){
rank(-BrandPreference$WeightedAverageRating)%in%1:index
}
BrandPreference <- mutate(BrandPreference, top=top(8))
ggplot(BrandPreference, mapping=aes(x=reorder(Brand,WeightedAverageRating), y=WeightedAverageRating,fill=top)) + geom_bar(stat = "identity",width = 0.8)+coord_flip()+geom_text(aes(label = WeightedAverageRating,hjust=1))
BrandPreference
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
runApp('Project/app.project.R')
library(dplyr)
library(ggplot2)
library(rvest)
library(fuzzyjoin)
library(formattable)
car <-read.csv('CarRentalData.csv')
#shiann adding cost price and fuel efficiency
#polaris slingshot is not found in israel
#Kia Sorento (ILS 117,266)
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- as.data.frame(kiasorento)
#Jaguar F Type is not yet found in israel (coming soon)
#Chevrolet Corvette Stingray (ILS 210,105)
corvette<- read_html("https://motowheeler.com/il/cars/chevrolet-corvette-stingray-1lt-coupe-1098")
corvette <- corvette %>% html_nodes("body") %>% html_table()
corvette <- as.data.frame(corvette)
#x <- merge(kiasorento,corvette,"X1",all=T)
#MINI Cooper Countryman (ILS 100,395)
countryman <- read_html("https://motowheeler.com/il/cars/mini-cooper-countryman-2022-3464")
countryman <- countryman %>% html_nodes("body") %>% html_table()
countryman <- as.data.frame(countryman)
#Subaru Outback (ILS 92,960)
outback <- read_html("https://motowheeler.com/il/cars/subaru-outback-base-1556")
outback <- outback %>% html_nodes("body") %>% html_table()
outback <- as.data.frame(outback)
#Porsche 911 (ILS 349,140)
porsche <- read_html("https://motowheeler.com/il/cars/porsche-911-carrere-car-8239")
porsche <- porsche %>% html_nodes("body") %>% html_table()
porsche <- as.data.frame(porsche)
#Mersedes C class (https://www.mercedes-benz.co.il/mercedes_models/c_class_coupe/c300-coupe/) need help
#Mini Cooper (ILS79,005)
mini <- read_html("https://motowheeler.com/il/cars/jeep-wrangler-unlimited-willys-2022-5158")
mini <- mini %>% html_nodes("body") %>% html_table()
mini <- as.data.frame(mini)
#Jeep Wrangler JK (ILS 115,903)
JK <- read_html("https://motowheeler.com/il/cars/mini-cooper-hardtop-2-door-2022-3592")
JK <- JK %>% html_nodes("body") %>% html_table()
JK <- as.data.frame(JK)
#mergedata frames together + input the price in ILS (israeli shekels)
car$vehicle.age <- 2020 - car$vehicle.year
shiny::runApp('Project')
?img
runApp('Project')
runApp('Project')
runApp('Project')
install.packages("jpeg")
runApp('Project')
runApp('Project')
install.packages("shinythemes")
runApp('Project')
runApp('Project')
runApp('Project')
runApp('DBA3702 (AY20:21 sem2)/AY2021/R project')
runApp('Project')
runApp('Project')
str(JK)
JK
View(JK)
runApp('Project')
#Kia Sorento (ILS 117,266)
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- as.data.frame(kiasorento)
kiasorento <- kiasorento[-1,]
#Jaguar F Type is not yet found in israel (coming soon)
#Chevrolet Corvette Stingray (ILS 210,105)
corvette<- read_html("https://motowheeler.com/il/cars/chevrolet-corvette-stingray-1lt-coupe-1098")
corvette <- corvette %>% html_nodes("body") %>% html_table()
corvette <- as.data.frame(corvette)
corvette <- corvette[-1,]
#x <- merge(kiasorento,corvette,"X1",all=T)
#MINI Cooper Countryman (ILS 100,395)
countryman <- read_html("https://motowheeler.com/il/cars/mini-cooper-countryman-2022-3464")
countryman <- countryman %>% html_nodes("body") %>% html_table()
countryman <- as.data.frame(countryman)
countryman <- countryman[-1,]
#Subaru Outback (ILS 92,960)
outback <- read_html("https://motowheeler.com/il/cars/subaru-outback-base-1556")
outback <- outback %>% html_nodes("body") %>% html_table()
outback <- as.data.frame(outback)
outback <- outback[-1,]
#Porsche 911 (ILS 349,140)
porsche <- read_html("https://motowheeler.com/il/cars/porsche-911-carrere-car-8239")
porsche <- porsche %>% html_nodes("body") %>% html_table()
porsche <- as.data.frame(porsche)
porsche <- porsche[-1,]
#Mersedes C class
C.class <- read_html("https://motowheeler.com/il/cars/mercedes-benz-c300-cabriolet-2023-6317")
C.class <- C.class %>% html_nodes("body") %>% html_table()
C.class <- as.data.frame(C.class)
C.class <- C.class[-1,]
#Mini Cooper (ILS79,005)
mini <- read_html("https://motowheeler.com/il/cars/mini-cooper-hardtop-2-door-2022-3592")
mini <- mini %>% html_nodes("body") %>% html_table()
mini <- as.data.frame(mini)
mini <- mini[-1,]
#Jeep Wrangler JK (ILS 115,903)
JK <- read_html("https://motowheeler.com/il/cars/jeep-wrangler-unlimited-willys-2022-5158")
JK <- JK %>% html_nodes("body") %>% html_table()
JK <- as.data.frame(JK)
JK <- JK[-1,]
View(JK)
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
View(kiasorento)
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
View(kiasorento)
View(JK)
View(kiasorento)
View(corvette)
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- as.data.frame(kiasorento)
View(kiasorento)
runApp('Project')
data
runApp('Project')
runApp('Project')
runApp('~/Desktop/Untitled.R')
runApp('Project')
Name <- c("Jon", "Bill", "Maria", "Ben", "Tina")
Age <- c(23, 41, 32, 58, 26)
df <- data.frame(Name, Age)
typeof(return(df))
runApp('Project')
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- as.data.frame(kiasorento)
kiasorento%>%slice(which(df[,1]=="Basic Info"+1):which(df[,1]=="Body and Dimension"))
kiasorento%>%slice(which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
rlang::last_error()
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
df <- as.data.frame(kiasorento)
df %>% slice(which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
df %>% slice(which(df[,1]=="Basic Info"):which(df[,1]=="Body and Dimension"))
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
> kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
kiasorento <- read_html("https://motowheeler.com/il/hybrid-cars/kia-sorento-plug-in-hybrid-sx-awd-2023-8946")
kiasorento <- kiasorento %>% html_nodes("body") %>% html_table()
df <- as.data.frame(kiasorento)
df %>% slice(which(df[,1]=="Basic Info"):which(df[,1]=="Body and Dimension"))
which(df[,1]=="Basic Info")
which(df[,1]=="Basic Info")+1
df %>% slice(2:6)
df %>% slice(which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension"))
runApp('Project')
runApp('Project')
df %>% slice(which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
df
df %>% slice(which((df[,1]=="Basic Info")+1):(which(df[,1]=="Body and Dimension")-1))
df %>% slice(which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
slice(df,which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
which(df[,1]=="Basic Info")+1
slice(df,which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
slice(df,2:6)
which(df[,1]=="Body and Dimension")-1
runApp('Project')
slice(df,which(df[,1]=="Basic Info")+1:which(df[,1]=="Body and Dimension")-1)
which(df[,1]=="Tires")+1
which(df[,1]=="Wheels")-1
which(df[,1]=="Wheels")
runApp('Project')
return(df)
df
runApp('Project')
runApp('Project')
runApp('Project')
runApp('Project')
source('3702SA1Team9/runApp.R')
source('3702SA1Team9/runApp.R')
